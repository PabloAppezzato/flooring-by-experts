import { Injectable } from '@angular/core'; @Injectable({providedIn:'root'}) export class AuthService{ private tokenKey='fbe_token'; get token(){return localStorage.getItem(this.tokenKey);} set token(v){ if(v) localStorage.setItem(this.tokenKey,v); else localStorage.removeItem(this.tokenKey);} get role(){ const t=this.token; if(!t) return null; try{ return JSON.parse(atob(t.split('.')[1])).role; }catch{return null;} } googleLogin(){ window.location.href='http://localhost:4000/api/auth/google'; }}
